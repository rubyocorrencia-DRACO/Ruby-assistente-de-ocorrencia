Ruby OcorrÃªncias Bot - Telegram
Bot de Telegram para registro e acompanhamento de ocorrÃªncias tÃ©cnicas em campo com integraÃ§Ã£o ao Google Sheets e Google Forms.

ğŸš€ Funcionalidades
AutenticaÃ§Ã£o via Google Sheets: Login com formato especÃ­fico (ex: Z481036)
Registro de OcorrÃªncias: Sistema organizado por tipos de ocorrÃªncia
IntegraÃ§Ã£o Google Forms: Links especÃ­ficos para cada tipo de ocorrÃªncia
HistÃ³rico: Consulta de ocorrÃªncias anteriores
Consulta por Contrato: Busca de ocorrÃªncias por nÃºmero de contrato
Interface Web: Painel de status e instruÃ§Ãµes
ğŸ“‹ Comandos do Bot
/start - Inicializar conta no sistema
/login - Autenticar como tÃ©cnico (formato: uma letra + 3-6 nÃºmeros)
/ocorrencia - Registrar nova ocorrÃªncia
/historico - Ver ocorrÃªncias recentes
/status <nÃºmero> - Consultar ocorrÃªncias por contrato
/help - Mostrar ajuda completa
ğŸ”§ InstalaÃ§Ã£o
1. Clone o repositÃ³rio
git clone https://github.com/seu-usuario/ruby-ocorrencias-bot.git
cd ruby-ocorrencias-bot
2. Instale as dependÃªncias
npm install
3. Configure as variÃ¡veis de ambiente
Copie o arquivo .env.example para .env e configure:

cp .env.example .env
Configure as seguintes variÃ¡veis no arquivo .env:

# Token do bot do Telegram (obtenha com @BotFather)
TELEGRAM_BOT_TOKEN=seu_token_aqui
# URL do webhook para produÃ§Ã£o (ex: https://seu-app.onrender.com)
TELEGRAM_WEBHOOK_URL=https://seu-app.onrender.com
# Credenciais do Google Sheets (JSON completo da service account)
GOOGLE_CREDENTIALS_JSON={"type":"service_account","project_id":"..."}
# ConfiguraÃ§Ãµes opcionais
NODE_ENV=development
PORT=5000
4. Configure as planilhas do Google Sheets
Planilha de UsuÃ¡rios
URL: https://docs.google.com/spreadsheets/d/1o6UwDTMZGyehaTAvdtyF7mD3vd1ZvgiEc2OEtiSG450/edit

Colunas:

A: Login (ex: Z481036)
B: Nome Completo
C: Telefone
D: Ãrea de AtuaÃ§Ã£o
E: Ativo (TRUE/FALSE)
Planilha de Administradores
URL: https://docs.google.com/spreadsheets/d/1SCsmn4tcQWA42q5tVYALtrcJ775MRb6ynbD3f97JmFs/edit

Colunas:

A: Login (ex: Z481036)
B: Nome
C: Ativo (TRUE/FALSE)
5. Configure os Google Forms
Edite o arquivo server/google-sheets.ts e substitua os links dos formulÃ¡rios:

export const FORMULARIOS_OCORRENCIA = {
  '1': {
    nome: 'Rede Externa',
    url: 'SEU_LINK_DO_GOOGLE_FORMS_AQUI'
  },
  // ... outros formulÃ¡rios
};
6. Execute o projeto
Desenvolvimento
npm run dev
ProduÃ§Ã£o
npm run build
npm start
ğŸ” ConfiguraÃ§Ã£o das Credenciais do Google
1. Acesse o Google Cloud Console
VÃ¡ para https://console.cloud.google.com
Crie um novo projeto ou selecione um existente
2. Ative a API do Google Sheets
VÃ¡ para "APIs e ServiÃ§os" > "Biblioteca"
Procure por "Google Sheets API"
Clique em "Ativar"
3. Crie uma Service Account
VÃ¡ para "APIs e ServiÃ§os" > "Credenciais"
Clique em "Criar Credenciais" > "Conta de ServiÃ§o"
Preencha os dados da conta de serviÃ§o
Baixe o arquivo JSON com as credenciais
4. Configure as permissÃµes
Abra as planilhas do Google Sheets
Clique em "Compartilhar"
Adicione o email da service account com permissÃ£o de "Editor"
5. Configure a variÃ¡vel de ambiente
Copie todo o conteÃºdo do arquivo JSON baixado e cole como valor da variÃ¡vel GOOGLE_CREDENTIALS_JSON.

ğŸš€ Deploy no Render
1. Conecte o repositÃ³rio
Acesse https://render.com
Conecte sua conta do GitHub
Selecione o repositÃ³rio
2. Configure as variÃ¡veis de ambiente
No painel do Render, adicione todas as variÃ¡veis do arquivo .env:

TELEGRAM_BOT_TOKEN
TELEGRAM_WEBHOOK_URL
GOOGLE_CREDENTIALS_JSON
NODE_ENV=production
3. Configure o build
Build Command: npm run build
Start Command: npm start
ğŸ“ Estrutura do Projeto
ruby-ocorrencias-bot/
â”œâ”€â”€ client/                 # Frontend React
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # Componentes UI
â”‚   â”‚   â”œâ”€â”€ pages/          # PÃ¡ginas da aplicaÃ§Ã£o
â”‚   â”‚   â””â”€â”€ lib/            # UtilitÃ¡rios
â”œâ”€â”€ server/                 # Backend Express
â”‚   â”œâ”€â”€ bot/                # LÃ³gica do bot Telegram
â”‚   â”‚   â”œâ”€â”€ index.ts        # InicializaÃ§Ã£o do bot
â”‚   â”‚   â””â”€â”€ commands.ts     # Comandos e handlers
â”‚   â”œâ”€â”€ google-sheets.ts    # IntegraÃ§Ã£o Google Sheets
â”‚   â”œâ”€â”€ storage.ts          # Sistema de armazenamento
â”‚   â”œâ”€â”€ routes.ts           # Rotas da API
â”‚   â””â”€â”€ index.ts            # Servidor principal
â”œâ”€â”€ shared/                 # Schemas compartilhados
â”‚   â””â”€â”€ schema.ts           # DefiniÃ§Ãµes do banco de dados
â”œâ”€â”€ .env.example            # Exemplo de configuraÃ§Ã£o
â”œâ”€â”€ package.json            # DependÃªncias
â””â”€â”€ README.md               # DocumentaÃ§Ã£o
ğŸ”„ Fluxo de Uso
InicializaÃ§Ã£o: UsuÃ¡rio envia /start
AutenticaÃ§Ã£o: UsuÃ¡rio faz /login com cÃ³digo (ex: Z481036)
ValidaÃ§Ã£o: Bot verifica nas planilhas do Google Sheets
Registro: UsuÃ¡rio escolhe tipo de ocorrÃªncia com /ocorrencia
FormulÃ¡rio: Bot fornece link do Google Forms especÃ­fico
ConfirmaÃ§Ã£o: Bot confirma que a ocorrÃªncia foi gerada
ğŸ› ï¸ Desenvolvimento
Modo de Desenvolvimento
O bot inclui um modo de desenvolvimento que simula a autenticaÃ§Ã£o quando as credenciais do Google nÃ£o estÃ£o configuradas.

Logs
Todos os logs importantes sÃ£o exibidos no console para facilitar o debug.

Testes
Para testar o bot localmente:

Configure apenas o TELEGRAM_BOT_TOKEN
Execute npm run dev
O bot funcionarÃ¡ em modo de desenvolvimento
ğŸ“ Suporte
Para dÃºvidas ou problemas:

Verifique os logs do servidor
Confirme se as credenciais do Google estÃ£o corretas
Verifique se o bot tem acesso Ã s planilhas
Entre em contato com a administraÃ§Ã£o
ğŸ“ LicenÃ§a
MIT License - veja o arquivo LICENSE para detalhes.

Ruby Telecom - Sistema de OcorrÃªncias TÃ©cnicas
